/*! For license information please see taskpane.js.LICENSE.txt */
!function(){function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}function n(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||l(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(n){if(null!=n){var r=n["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],t=0;if(r)return r.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length))return{next:function(){return n&&t>=n.length&&(n=void 0),{value:n&&n[t++],done:!n}}}}throw new TypeError(e(n)+" is not iterable")}function t(){var e,n,r="function"==typeof Symbol?Symbol:{},s=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,t,s,o){var i=t&&t.prototype instanceof l?t:l,u=Object.create(i.prototype);return a(u,"_invoke",function(r,t,a){var s,o,i,l=0,u=a||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(n,r){return s=n,o=0,i=e,f.n=r,c}};function p(r,t){for(o=r,i=t,n=0;!d&&l&&!a&&n<u.length;n++){var a,s=u[n],p=f.p,h=s[2];r>3?(a=h===t)&&(i=s[(o=s[4])?5:(o=3,3)],s[4]=s[5]=e):s[0]<=p&&((a=r<2&&p<s[1])?(o=0,f.v=t,f.n=s[1]):p<h&&(a=r<3||s[0]>t||t>h)&&(s[4]=r,s[5]=t,f.n=h,o=0))}if(a||r>1)return c;throw d=!0,t}return function(a,u,h){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,h),o=u,i=h;(n=o<2?e:i)||!d;){s||(o?o<3?(o>1&&(f.n=-1),p(o,i)):f.n=i:f.v=i);try{if(l=2,s){if(o||(a="next"),n=s[a]){if(!(n=n.call(s,i)))throw TypeError("iterator result is not an object");if(!n.done)return n;i=n.value,o<2&&(o=0)}else 1===o&&(n=s.return)&&n.call(s),o<2&&(i=TypeError("The iterator does not provide a '"+a+"' method"),o=1);s=e}else if((n=(d=f.n<0)?i:r.call(t,f))!==c)break}catch(n){s=e,o=1,i=n}finally{l=1}}return{value:n,done:d}}}(r,s,o),!0),u}var c={};function l(){}function u(){}function d(){}n=Object.getPrototypeOf;var f=[][s]?n(n([][s]())):(a(n={},s,function(){return this}),n),p=d.prototype=l.prototype=Object.create(f);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,a(e,o,"GeneratorFunction")),e.prototype=Object.create(p),e}return u.prototype=d,a(p,"constructor",d),a(d,"constructor",u),u.displayName="GeneratorFunction",a(d,o,"GeneratorFunction"),a(p),a(p,o,"Generator"),a(p,s,function(){return this}),a(p,"toString",function(){return"[object Generator]"}),(t=function(){return{w:i,m:h}})()}function a(e,n,r,t){var s=Object.defineProperty;try{s({},"",{})}catch(e){s=0}a=function(e,n,r,t){function o(n,r){a(e,n,function(e){return this._invoke(n,r,e)})}n?s?s(e,n,{value:r,enumerable:!t,configurable:!t,writable:!t}):e[n]=r:(o("next",0),o("throw",1),o("return",2))},a(e,n,r,t)}function s(e,n,r,t,a,s,o){try{var i=e[s](o),c=i.value}catch(e){return void r(e)}i.done?n(c):Promise.resolve(c).then(t,a)}function o(e){return function(){var n=this,r=arguments;return new Promise(function(t,a){var o=e.apply(n,r);function i(e){s(o,t,a,i,c,"next",e)}function c(e){s(o,t,a,i,c,"throw",e)}i(void 0)})}}function i(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=l(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,i=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){i=!0,s=e},f:function(){try{o||null==r.return||r.return()}finally{if(i)throw s}}}}function c(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var t,a,s,o,i=[],c=!0,l=!1;try{if(s=(r=r.call(e)).next,0===n){if(Object(r)!==r)return;c=!1}else for(;!(c=(t=s.call(r)).done)&&(i.push(t.value),i.length!==n);c=!0);}catch(e){l=!0,a=e}finally{try{if(!c&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(l)throw a}}return i}}(e,n)||l(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,n){if(e){if("string"==typeof e)return u(e,n);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,n):void 0}}function u(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=Array(n);r<n;r++)t[r]=e[r];return t}Office.onReady(function(e){var n,a;if(e.host===Office.HostType.Word){null===(n=document.getElementById("sideload-msg"))||void 0===n||n.setAttribute("style","display:none"),null===(a=document.getElementById("app-body"))||void 0===a||a.setAttribute("style","display:flex"),function(){try{var e=function(){var e=o(t().m(function e(n){var r,a,s;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,n.text();case 1:return r=e.v,a=JSON.parse(r),c(a),e.a(2,!0);case 2:return e.p=2,s=e.v,console.error("[SGC] Failed to read/parse file:",s),i("Invalid rules.json (cannot parse).","#c00"),e.a(2,!1)}},e,null,[[0,2]])}));return function(n){return e.apply(this,arguments)}}(),n=function(){var n=o(t().m(function n(){return t().w(function(n){for(;;)switch(n.n){case 0:if(!r){n.n=2;break}return n.n=1,new Promise(function(n){r.value="";var a=function(){var s=o(t().m(function s(){var o,i;return t().w(function(t){for(;;)switch(t.n){case 0:if(r.removeEventListener("change",a),!(r.files&&r.files.length>0)){t.n=2;break}return o=n,t.n=1,e(r.files[0]);case 1:i=t.v,o(i),t.n=3;break;case 2:n(!1);case 3:return t.a(2)}},s)}));return function(){return s.apply(this,arguments)}}();r.addEventListener("change",a,{once:!0}),r.click()});case 1:return n.a(2,n.v);case 2:return n.a(2,!1)}},n)}));return function(){return n.apply(this,arguments)}}(),r=document.getElementById("rulesFileInput"),a=document.getElementById("loadRulesBtn"),s=document.getElementById("rulesStatus"),i=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#555";s&&(s.textContent=e,s.style.color=n)},c=function(e){!function(e){window.styleGuideRules=e}(e),i("Rules loaded.","#0a0"),function(e){try{var n=document.getElementById("rulesDump")||document.getElementById("rulesPreview")||document.getElementById("rulesBox");if(!n){var r=document.getElementById("rulesStatus");(n=document.createElement("pre")).id="rulesPreview";var t=n.style;t.whiteSpace="pre-wrap",t.wordBreak="break-word",t.marginTop="8px",t.padding="8px 10px",t.border="1px solid #ddd",t.borderRadius="4px",t.background="#f4f4f4",t.maxHeight="260px",t.overflow="auto",null!=r&&r.parentElement?r.parentElement.appendChild(n):document.body.appendChild(n)}var a=JSON.stringify(null!=e?e:{},null,2);n.textContent=a.length>81920?a.slice(0,81920)+"\n…(truncated)…":a}catch(e){console.error("Error rendering rules preview:",e)}}(e)};r&&(r.accept=".json,application/json",r.addEventListener("change",o(t().m(function n(){return t().w(function(n){for(;;)switch(n.n){case 0:if(r.files&&0!==r.files.length){n.n=1;break}return n.a(2);case 1:return n.n=2,e(r.files[0]);case 2:return n.a(2)}},n)})))),a&&a.addEventListener("click",o(t().m(function a(){var s;return t().w(function(t){for(;;)switch(t.n){case 0:if(i("Loading rules…"),null==r||null===(s=r.files)||void 0===s||!s.length){t.n=2;break}return t.n=1,e(r.files[0]);case 1:if(!t.v){t.n=2;break}return t.a(2);case 2:return t.n=3,n();case 3:t.v||i("Please choose rules.json manually.","#c00");case 4:return t.a(2)}},a)})))}catch(e){console.error("Error binding rules loader:",e)}}(),function(){try{var e=document.getElementById("scanBtn"),n=document.getElementById("scanStatus"),a=document.getElementById("issuesList");if(!e||!n||!a)return;e.addEventListener("click",o(t().m(function e(){var s,c,l,u,f,h,w,E,S,x,I,T,L,N,M,G,U,$,P,W,_,z,Y,Z,q,H,Q,X;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,I=m()){e.n=1;break}return n.textContent="Load a rules JSON first.",n.style.color="#c00",e.a(2);case 1:return n.textContent="Scanning…",n.style.color="#555",a.innerHTML="",T=[],L=(null==I||null===(s=I.meta)||void 0===s?void 0:s.styleNameAliases)||{},N=(null==I||null===(c=I.rules)||void 0===c||null===(c=c.indentation)||void 0===c?void 0:c.expectedCmByStyle)||{},M=Math.max(null!==(l=null==I||null===(u=I.rules)||void 0===u||null===(u=u.indentation)||void 0===u?void 0:u.toleranceCm)&&void 0!==l?l:.03,.02),G=null!==(f=null==I||null===(h=I.rules)||void 0===h||null===(h=h.styles)||void 0===h||null===(h=h.headings)||void 0===h?void 0:h.allowed)&&void 0!==f?f:[],U=new Set(G.map(function(e){return v(e,L)})),$=(null==I||null===(w=I.rules)||void 0===w||null===(w=w.styles)||void 0===w?void 0:w.captions)||{},P=$.figure||{},W=$.table||{},_=b(null!==(E=P.style)&&void 0!==E?E:"TCC 그림 캡션",L),z=b(null!==(S=null!==(x=W.styles)&&void 0!==x?x:W.style)&&void 0!==S?S:"캡션,TCC 표 캡션,표캡션TCC",L),Y=k(P.seqLabels,["Figure","그림"]),Z=k(W.seqLabels,["Table","표"]),q=!1!==P.requireAutoNumber,H=!1!==W.requireAutoNumber,e.p=2,e.n=3,Word.run(function(){var e=o(t().m(function e(n){var r,a,s,o,c;return t().w(function(e){for(;;)switch(e.n){case 0:return(r=n.document.contentControls).load("items/tag"),e.n=1,n.sync();case 1:a=r.items.filter(function(e){return e.tag&&e.tag.startsWith(d)}),s=i(a);try{for(s.s();!(o=s.n()).done;){c=o.value;try{c.delete(!0)}catch(e){console.warn("Error deleting existing marker:",e)}}}catch(e){s.e(e)}finally{s.f()}return e.n=2,n.sync();case 2:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}());case 3:e.n=5;break;case 4:e.p=4,Q=e.v,console.warn("Error clearing existing markers:",Q);case 5:return e.n=6,Word.run(function(){var e=o(t().m(function e(a){var s,o,i,c,l,u,d,f,h,m,b,k,w,E,S,x,G,D,$,P,W,Q,X,J,V,K,ee,ne,re,te,ae,se,oe,ie,ce,le,ue,de,fe,pe,he,ge,ye,me;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:e.p=0,s=a.document.body,o=0;case 1:return e.p=2,(i=s.paragraphs).load({select:"style,text,isListItem,leftIndent,firstLineIndent",top:y,skip:o}),e.n=3,a.sync();case 3:if(0!==i.items.length){e.n=4;break}return e.a(3,12);case 4:return e.n=5,A(a,i);case 5:c=e.v,l=t().m(function e(){var n,r,s,o,l,d,f,h,y,m,b,k,w,E;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,n=i.items[u],!c[u]){e.n=1;break}return e.a(2,0);case 1:return e.n=2,B(a,n,I,L,T);case 2:if(r=n.style||"",s=v(r,L),!((o=n.text||"").includes("텍스트를 입력하려면 여기를 클릭하거나 탭하세요")||o.includes("Click or tap here to enter text")||o.includes("Type here")||""===o.trim()||/^(\[.*\]|\{.*\}|\(.*\))$/.test(o.trim()))){e.n=3;break}return e.a(2,0);case 3:if(!(U.has(s)||/^(heading|제목)\s*\d+/.test(s)||/^(heading|제목)\s*\d+/.test((r||"").toLowerCase()))){e.n=4;break}return e.a(2,0);case 4:if(e.p=4,l=p(n.leftIndent||0),d=p(n.firstLineIndent||0),f=l+d,"number"!=typeof(h=function(){if(N[r])return N[r];var e=v(r,L);return N[e]?N[e]:void 0}())){e.n=8;break}if(y=o.trim(),m=/^[\u2022\u25E6\u25AA\u25CF\u25CB\u25A0\-–·•◦○▪□]\s+/.test(y)||/^(\(?\d{1,3}|\(?[A-Za-z]{1,3}|\(?[IVXLCM]{1,4})[.)]\s+/i.test(y)||/^\d+\s+/.test(y),n.isListItem&&m||!(Math.abs(f-h)>M)){e.n=8;break}return e.p=5,e.n=6,C(a,n);case 6:b=e.v,T.push({tag:b,kind:"indent",message:"Indent "+g(f)+" cm (expected "+g(h)+' cm) for style "'+(r||s)+'".',fixMeta:{expectedCm:h}}),e.n=8;break;case 7:e.p=7,k=e.v,console.warn("Error marking indent issue:",k);case 8:e.n=10;break;case 9:e.p=9,w=e.v,console.warn("Error checking indentation:",w);case 10:e.n=12;break;case 11:e.p=11,E=e.v,console.warn("Error processing paragraph ".concat(u,":"),E);case 12:return e.a(2)}},e,null,[[5,7],[4,9],[0,11]])}),u=0;case 6:if(!(u<i.items.length)){e.n=9;break}return e.d(r(l()),7);case 7:if(0!==e.v){e.n=8;break}return e.a(3,8);case 8:u++,e.n=6;break;case 9:o+=i.items.length,e.n=11;break;case 10:if(e.p=10,ae=e.v,console.error("Error processing batch starting at ".concat(o,":"),ae),!((o+=y)>1e4)){e.n=11;break}return e.a(3,12);case 11:e.n=1;break;case 12:d=0;case 13:return e.p=14,(f=s.paragraphs).load({select:"style,text",top:y,skip:d}),e.n=15,a.sync();case 15:if(0!==f.items.length){e.n=16;break}return e.a(3,73);case 16:return e.n=17,A(a,f);case 17:h=e.v,m=0;case 18:if(!(m<f.items.length)){e.n=70;break}if(e.p=19,!h[m]){e.n=20;break}return e.a(3,69);case 20:if(b=f.items[m],k=b.style||"",w=v(k,L),!((E=b.text||"").includes("텍스트를 입력하려면 여기를 클릭하거나 탭하세요")||E.includes("Click or tap here to enter text")||E.includes("Type here")||""===E.trim()||/^(\[.*\]|\{.*\}|\(.*\))$/.test(E.trim()))){e.n=21;break}return e.a(3,69);case 21:if(S=_.has(w)||_.has(k),x=z.has(w)||z.has(k),G=F(E,Y),D=F(E,Z),P=x||D,($=S||G)||P){e.n=22;break}return e.a(3,69);case 22:if(W=!1,Q=!1,!$){e.n=26;break}return e.p=23,e.n=24,O(a,b,"Figure");case 24:W=e.v,e.n=26;break;case 25:e.p=25,se=e.v,console.warn("Error checking figure fields:",se);case 26:if(!P){e.n=30;break}return e.p=27,e.n=28,O(a,b,"Table");case 28:Q=e.v,e.n=30;break;case 29:e.p=29,oe=e.v,console.warn("Error checking table fields:",oe);case 30:if(!S){e.n=40;break}if(W||!q){e.n=35;break}return e.p=31,e.n=32,C(a,b);case 32:X=e.v,T.push({tag:X,kind:"figure-style",message:"Figure caption uses manual numbering. Expected { STYLEREF 1 \\s }.{ SEQ Figure \\* ARABIC \\s 1 }"}),e.n=34;break;case 33:e.p=33,ie=e.v,console.warn("Error marking figure issue:",ie);case 34:e.n=39;break;case 35:if(!W){e.n=39;break}if(j(E,Y)){e.n=39;break}return e.p=36,e.n=37,C(a,b);case 37:J=e.v,T.push({tag:J,kind:"figure-empty",message:"Figure caption is empty."}),e.n=39;break;case 38:e.p=38,ce=e.v,console.warn("Error marking empty figure:",ce);case 39:e.n=48;break;case 40:if(!G){e.n=48;break}if(W){e.n=45;break}if(R(E,Y)){e.n=44;break}return e.p=41,e.n=42,C(a,b);case 42:V=e.v,T.push({tag:V,kind:"figure-style",message:"Figure-like text uses neither automatic numbering nor the correct caption style."}),e.n=44;break;case 43:e.p=43,le=e.v,console.warn("Error marking figure style issue:",le);case 44:e.n=48;break;case 45:return e.p=45,e.n=46,C(a,b);case 46:K=e.v,T.push({tag:K,kind:"figure-style",message:"Figure caption uses the wrong style. Apply the designated figure caption style."}),e.n=48;break;case 47:e.p=47,ue=e.v,console.warn("Error marking figure wrong style:",ue);case 48:if(!x){e.n=58;break}if(Q||!H){e.n=53;break}return e.p=49,e.n=50,C(a,b);case 50:ee=e.v,T.push({tag:ee,kind:"table-style",message:"Table caption uses manual numbering. Expected { STYLEREF 1 \\s }.{ SEQ Table \\* ARABIC \\s 1 }"}),e.n=52;break;case 51:e.p=51,de=e.v,console.warn("Error marking table issue:",de);case 52:e.n=57;break;case 53:if(!Q){e.n=57;break}if(j(E,Z)){e.n=57;break}return e.p=54,e.n=55,C(a,b);case 55:ne=e.v,T.push({tag:ne,kind:"table-empty",message:"Table caption is empty."}),e.n=57;break;case 56:e.p=56,fe=e.v,console.warn("Error marking empty table:",fe);case 57:e.n=67;break;case 58:if(!D){e.n=67;break}if(Q){e.n=63;break}if(R(E,Z)){e.n=62;break}return e.p=59,e.n=60,C(a,b);case 60:re=e.v,T.push({tag:re,kind:"table-style",message:"Table-like text uses neither automatic numbering nor the correct caption style."}),e.n=62;break;case 61:e.p=61,pe=e.v,console.warn("Error marking table style issue:",pe);case 62:e.n=67;break;case 63:if(x){e.n=67;break}return e.p=64,e.n=65,C(a,b);case 65:te=e.v,T.push({tag:te,kind:"table-style",message:"Table caption uses the wrong style. Apply the designated table caption style."}),e.n=67;break;case 66:e.p=66,he=e.v,console.warn("Error marking table wrong style:",he);case 67:e.n=69;break;case 68:e.p=68,ge=e.v,console.warn("Error processing caption ".concat(m,":"),ge);case 69:m++,e.n=18;break;case 70:d+=f.items.length,e.n=72;break;case 71:if(e.p=71,ye=e.v,console.error("Error processing caption batch starting at ".concat(d,":"),ye),!((d+=y)>1e4)){e.n=72;break}return e.a(3,73);case 72:e.n=13;break;case 73:e.n=75;break;case 74:return e.p=74,me=e.v,console.error("Error in main scan logic:",me),n.textContent="Scan failed with error: "+me.message,n.style.color="#c00",e.a(2);case 75:return e.a(2)}},e,null,[[64,66],[59,61],[54,56],[49,51],[45,47],[41,43],[36,38],[31,33],[27,29],[23,25],[19,68],[14,71],[2,10],[0,74]])}));return function(n){return e.apply(this,arguments)}}());case 6:window.__SGC_ISSUES__=T,D(T),0===T.length?(n.textContent="Scan complete. No issues found.",n.style.color="#0a0"):(n.textContent="Scan complete. Found "+T.length+" issue(s).",n.style.color="#a60"),e.n=8;break;case 7:e.p=7,X=e.v,console.error("Critical error in scan:",X),n.textContent="Scan failed: "+X.message,n.style.color="#c00";case 8:return e.a(2)}},e,null,[[2,4],[0,7]])})))}catch(e){console.error("Error binding scan:",e)}}(),function(){try{var e=document.getElementById("issuesList");if(!e)return;e.addEventListener("click",function(e){try{var n=e.target.closest("li.issue");if(!n)return;var r=n.dataset.tag;if(!r)return;(function(e){return U.apply(this,arguments)})(r).catch(function(e){console.error("Error jumping to issue:",e)})}catch(e){console.warn("Error handling issue row click:",e)}})}catch(e){console.error("Error binding issue row clicks:",e)}}();var s=document.getElementById("clearMarkersBtn")||document.getElementById("clearMarkers");null==s||s.addEventListener("click",function(){return function(){return G.apply(this,arguments)}().catch(console.error)})}});var d="sgc-",f=28.3464567,p=function(e){return(e||0)/f},h=function(e){return(e||0)*f},g=function(e){return Math.round(100*e)/100},y=500;function m(){return window.styleGuideRules}function v(e,n){try{var r=(e||"").toString().trim().replace(/\s+/g," ").toLowerCase();if(!n)return r;for(var t=0,a=Object.entries(n);t<a.length;t++){var s=c(a[t],2),o=s[0],i=s[1];if((o||"").toString().trim().replace(/\s+/g," ").toLowerCase()===r)return(i||"").toString().trim().replace(/\s+/g," ").toLowerCase()}return r}catch(n){return console.warn("Error normalizing style:",n),(e||"").toString().trim().toLowerCase()}}function b(e,n){try{var r,t=Array.isArray(e)?e:[e],a=new Set,s=i(t);try{for(s.s();!(r=s.n()).done;){var o=r.value;a.add(o),a.add(v(o,n))}}catch(e){s.e(e)}finally{s.f()}return{set:a,has:function(e){try{return a.has(e)||a.has(v(e,n))}catch(e){return!1}}}}catch(e){return console.warn("Error creating normalized style list:",e),{set:new Set,has:function(){return!1}}}}function k(e,n){try{return Array.isArray(e)?e:"string"==typeof e&&e.trim()?[e.trim()]:n}catch(e){return n}}var w=0;function E(){return String(w+=1).padStart(6,"0")}function C(e,n){return S.apply(this,arguments)}function S(){return(S=o(t().m(function e(n,r){var a,s,o,i;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,a=E(),s=r.getRange(),(o=s.insertContentControl()).tag=d+a,o.title="Style Guide Issue",o.appearance="Hidden",e.n=1,n.sync();case 1:return e.a(2,a);case 2:return e.p=2,i=e.v,console.error("Error marking paragraph:",i),e.a(2,E())}},e,null,[[0,2]])}))).apply(this,arguments)}function x(e){try{var n=(e||"").toString().trim().toLowerCase();return/^toc(\s*\d+)?$/.test(n)||"toc heading"===n||"목차"===n||/목차\s*\d+/.test(n)||"table of contents"===n||/^contents(\s*\d+)?$/.test(n)||/^차례(\s*\d+)?$/.test(n)||"차례"===n||n.includes("table of contents")||n.includes("목차")}catch(e){return!1}}function I(e){try{var n=(e||"").replace(/\u00A0/g," ").trim();return/[.\u2026\u00B7\u2219]{3,}\s*\t+\s*\d+$/.test(n)||/[.\u2026\u00B7\u2219]{5,}\s*\d+$/.test(n)||/[.\u2026\u00B7\u2219]{3,}\s{2,}\d+$/.test(n)||/\t+\s*\d+$/.test(n)||/\s{3,}\d+$/.test(n)||/\d+\.\d+.*[\.\u2026\u00B7\u2219]{2,}.*\d+$/.test(n)}catch(e){return!1}}function A(e,n){return T.apply(this,arguments)}function T(){return(T=o(t().m(function e(n,a){var s,o,c,l,u,d,f,p,h,g,y,m,v,b,k,w,E,C,S,A,T,B,L,R,N;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,s=new Array(a.items.length).fill(!1),a.items.forEach(function(e,n){try{var r=(e.style||"").toLowerCase(),t=(e.text||"").trim();if(x(r)||I(t))return void(s[n]=!0);(t.toLowerCase().includes("table of contents")||t.toLowerCase().includes("목차")||t.toLowerCase().includes("차례"))&&(s[n]=!0)}catch(e){console.warn("Error checking TOC for paragraph ".concat(n,":"),e)}}),e.p=1,(o=n.document.body.getRange().fields).load("items"),e.n=2,n.sync();case 2:if(!(o.items&&o.items.length>0)){e.n=19;break}for(c=0,l=o.items;c<l.length;c++){u=l[c];try{null===(d=(f=u).load)||void 0===d||d.call(f,"code")}catch(e){console.warn("Error loading field code:",e)}}return e.p=3,e.n=4,n.sync();case 4:e.n=6;break;case 5:return e.p=5,T=e.v,console.warn("Error syncing field codes:",T),e.a(2,s);case 6:p=0,h=o.items;case 7:if(!(p<h.length)){e.n=19;break}if(g=h[p],e.p=8,m=String(null!==(y=null==g?void 0:g.code)&&void 0!==y?y:""),!/^\s*TOC\b/i.test(m)){e.n=16;break}if(!(k=null===(v=(b=g).getRange)||void 0===v?void 0:v.call(b))){e.n=16;break}return(w=k.paragraphs).load("items"),e.n=9,n.sync();case 9:E=i(w.items),e.p=10,S=t().m(function e(){var n,r,o;return t().w(function(e){for(;;)switch(e.n){case 0:n=C.value;try{r=n.text,o=n.style,a.items.forEach(function(e,n){e.text===r&&e.style===o&&(s[n]=!0)})}catch(e){console.warn("Error processing TOC paragraph:",e)}case 1:return e.a(2)}},e)}),E.s();case 11:if((C=E.n()).done){e.n=13;break}return e.d(r(S()),12);case 12:e.n=11;break;case 13:e.n=15;break;case 14:e.p=14,B=e.v,E.e(B);case 15:return e.p=15,E.f(),e.f(15);case 16:e.n=18;break;case 17:e.p=17,L=e.v,console.warn("Error processing individual field:",L);case 18:p++,e.n=7;break;case 19:e.n=21;break;case 20:e.p=20,R=e.v,console.warn("Error with field-based TOC detection:",R);case 21:return e.a(2,s);case 22:return e.p=22,N=e.v,console.error("Critical error in computeTocSkips:",N),e.a(2,new Array((null===(A=a.items)||void 0===A?void 0:A.length)||0).fill(!1))}},e,null,[[10,14,15,16],[8,17],[3,5],[1,20],[0,22]])}))).apply(this,arguments)}function B(e,n,r,t,a){return L.apply(this,arguments)}function L(){return(L=o(t().m(function e(r,a,s,o,i){var c,l,u,d,f,h,y,m,b,k,w,E,S,A,T,B,L,R,N,F,j,O,M,G,D,U,$,P,W,_,z,Y,Z,q,H,Q,X,J,V,K,ee,ne,re,te,ae,se,oe,ie,ce,le,ue,de,fe,pe,he,ge,ye;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,A=a.style||"",T=v(A,o),B=a.text||"",console.log('[DEBUG] Checking paragraph: "'+B.substring(0,50)+'..." | Style: "'+A+'" | Normalized: "'+T+'"'),!(B.includes("텍스트를 입력하려면 여기를 클릭하거나 탭하세요")||B.includes("Click or tap here to enter text")||B.includes("Type here")||""===B.trim()||/^(\[.*\]|\{.*\}|\(.*\))$/.test(B.trim()))){e.n=1;break}return console.log("[DEBUG] Skipping placeholder/empty paragraph"),e.a(2);case 1:if(!(x(A)||x(T)||I(B))){e.n=2;break}return console.log("[DEBUG] Skipping TOC-like content"),e.a(2);case 2:if(L=null!==(c=null==s||null===(l=s.rules)||void 0===l||null===(l=l.styles)||void 0===l?void 0:l.bullets)&&void 0!==c?c:{},R=null!==(u=null==s||null===(d=s.rules)||void 0===d||null===(d=d.styles)||void 0===d?void 0:d.numberedLists)&&void 0!==u?u:{},N=null!==(f=L.allowed)&&void 0!==f?f:["TCC 글머리1","TCC 글머리2","TCC 글머리3","TCC 글머리4"],F=null!==(h=R.allowed)&&void 0!==h?h:["TCC 번호1","TCC 번호2","TCC 번호3"],j=null!==(y=L.allowedIndentsCm)&&void 0!==y?y:[.71,1.21,1.71,2.21],O=null!==(m=R.allowedIndentsCm)&&void 0!==m?m:[.71,1.21,1.71],M=[].concat(n(N),n(F)),G=[].concat(n(j),n(O)),D=new Set,M.forEach(function(e){D.add(e),D.add(v(e,o))}),U=(null==s||null===(b=s.rules)||void 0===b||null===(b=b.indentation)||void 0===b?void 0:b.expectedCmByStyle)||{},$=Math.max(null!==(k=null==s||null===(w=s.rules)||void 0===w||null===(w=w.indentation)||void 0===w?void 0:w.toleranceCm)&&void 0!==k?k:.03,.02),P=null!==(E=null==s||null===(S=s.rules)||void 0===S||null===(S=S.styles)||void 0===S||null===(S=S.headings)||void 0===S?void 0:S.allowed)&&void 0!==E?E:[],!((W=new Set(P.map(function(e){return v(e,o)}))).has(T)||W.has(A)||/^(heading|제목)\s*\d+/.test(T)||/^(heading|제목)\s*\d+/.test((A||"").toLowerCase()))){e.n=3;break}return console.log("[DEBUG] Skipping heading style:",A),e.a(2);case 3:if(_=B.trim(),!(z=/^(\d+\.)*\d+\s+[A-Z]/.test(_)||/^\d+\.\s+[A-Z]/.test(_)||/^Chapter\s+\d+/i.test(_)||/^제\s*\d+/i.test(_))){e.n=4;break}return console.log("[DEBUG] Skipping heading-like text:",_.substring(0,30)),e.a(2);case 4:if(Y={hasBulletChar:/^[\u2022\u25E6\u25AA\u25CF\u25CB\u25A0•◦○▪□]\s+/.test(_),hasDashBullet:/^[\-–—]\s+/.test(_),hasNumbering:/^(\(?\d{1,2}\)|(\d{1,2}[\.)]))(\s+)/.test(_)&&!z,hasLettering:/^(\(?[A-Za-z]\)|([A-Za-z][\.)]))(\s+)/.test(_),hasRoman:/^(\(?[ivxlc]{1,4}\)|([ivxlc]{1,4}[\.)]))(\s+)/i.test(_),isWordList:!!a.isListItem,hasTabBullet:/^\t+[\u2022\u25E6\u25AA\u25CF\u25CB\u25A0•◦○▪□\-–—]\s+/.test(_),hasSpaceBullet:/^\s{2,}[\u2022\u25E6\u25AA\u25CF\u25CB\u25A0•◦○▪□\-–—]\s+/.test(_)},Z=Y.hasBulletChar||Y.hasDashBullet||Y.hasNumbering||Y.hasLettering||Y.hasRoman||Y.hasTabBullet||Y.hasSpaceBullet,q=Y.isWordList&&Z,H=Y.hasBulletChar||Y.hasDashBullet,Q=Y.hasNumbering||Y.hasLettering||Y.hasRoman,Y.isWordList||Z){e.n=5;break}return console.log("[DEBUG] Not a list, skipping list checks"),e.a(2);case 5:if(X=p(a.leftIndent||0),J=p(a.firstLineIndent||0),V=X+J,D.has(A)||D.has(T)){e.n=9;break}return console.log("[DEBUG] ❌ STYLE ISSUE FOUND - adding to issues"),e.p=6,e.n=7,C(r,a);case 7:K=e.v,H?(ee=Array.from(new Set(N)).join(", "),ne="bullet-style",re={currentIndent:V,allowedStyles:N,allowedIndents:j}):Q?(ee=Array.from(new Set(F)).join(", "),ne="numbered-style",re={currentIndent:V,allowedStyles:F,allowedIndents:O}):(ee=Array.from(new Set(M)).join(", "),ne="bullet-style",re={currentIndent:V,allowedStyles:N,allowedIndents:j}),i.push({tag:K,kind:ne,message:"List paragraph must use: "+ee+' (found "'+(A||T||"unknown")+'").',fixMeta:re}),e.n=9;break;case 8:e.p=8,fe=e.v,console.error("Error marking paragraph for style issue:",fe);case 9:if(!q){e.n=21;break}if(e.p=10,te=V,U[A]?ae=U[A]:(se=v(A,o),U[se]&&(ae=U[se])),void 0===ae){e.n=15;break}if(!(Math.abs(te-ae)>$)){e.n=14;break}return console.log("[DEBUG] ❌ INDENT ISSUE FOUND (specific policy) - adding to issues"),e.p=11,e.n=12,C(r,a);case 12:oe=e.v,i.push({tag:oe,kind:"indent",message:"Indent "+g(te)+" cm (expected "+g(ae)+' cm) for style "'+(A||T)+'".',fixMeta:{expectedCm:ae}}),e.n=14;break;case 13:e.p=13,pe=e.v,console.error("Error marking paragraph for indent issue:",pe);case 14:e.n=19;break;case 15:if(ce=(ie=H?j:Q?O:G).reduce(function(e,n){var r=Math.abs(te-n);return r<e.distance?{cm:n,distance:r}:e},{cm:ie[0],distance:Number.POSITIVE_INFINITY}),le=$+.03,!(ce.distance>le)){e.n=19;break}return console.log("[DEBUG] ❌ INDENT ISSUE FOUND (tier-based) - adding to issues"),e.p=16,e.n=17,C(r,a);case 17:ue=e.v,de=ie.map(function(e){return g(e)}).join(", "),i.push({tag:ue,kind:"indent",message:"List indent "+g(te)+" cm not in "+de+" cm.",fixMeta:{expectedCm:ce.cm}}),e.n=19;break;case 18:e.p=18,he=e.v,console.error("Error marking paragraph for tier indent issue:",he);case 19:e.n=21;break;case 20:e.p=20,ge=e.v,console.error("Error checking indent compliance:",ge);case 21:console.log("[DEBUG] --- End of list check for this paragraph ---\n"),e.n=23;break;case 22:e.p=22,ye=e.v,console.error("Error in checkBulletedListCompliance:",ye);case 23:return e.a(2)}},e,null,[[16,18],[11,13],[10,20],[6,8],[0,22]])}))).apply(this,arguments)}function R(e,n){try{var r=function(e,n){try{var r=(e||"").replace(/\u00A0/g," "),t=n.map(function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}).join("|"),a=new RegExp("^\\s*(?:"+t+")\\s*\\d+(?:\\.\\d+)*\\s*([\\s\\S]*)$","i").exec(r);return a?a[1].replace(/^\s+/,""):""}catch(e){return""}}(e,n);if(!r)return!1;if(/^[.:—–-]/.test(r))return!1;var t=/^[A-Za-z]+/.exec(r);if(t&&t[0].charAt(0)===t[0].charAt(0).toLowerCase())return!0;var a=r.split(/\s+/).slice(0,8).join(" ");return!!(/\b(the|this|that|these|those|a|an|our|its?|their|there|here|we|it|they|will|can|should|would|could|may|might|must)\b/i.test(a)||/\b(shows?|illustrates?|lists?|presents?|summarizes?|depicts?|compares?|gives?|displays?|demonstrates?|indicates?|describes?|contains?|includes?|provides?|represents?|reveals?|explains?|outlines?|details?|reports?|records?|tracks?|measures?|analyzes?|examines?)\b/i.test(a)||/\b(is|are|was|were|has|have|had|does|do|did|will|would|can|could|should|may|might|must)\b/i.test(a)||/\b(and|but|or|so|yet|for|nor|because|since|although|though|while|whereas|however|therefore|thus|hence)\b/i.test(a))||!/^[([{}]/.test(r)&&!!/[.!?]\s+[A-Z]/.test(r)}catch(e){return!1}}function N(e){try{return e.map(function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}).join("|")}catch(e){return""}}function F(e,n){try{var r=(e||"").replace(/\u00A0/g," ");return new RegExp("^\\s*(?:"+N(n)+")\\b","i").test(r)}catch(e){return!1}}function j(e,n){try{var r=(null!=e?e:"").replace(/\u00A0/g," "),t=new RegExp("^\\s*(?:"+N(n)+")\\s*\\d+(?:\\.\\d+)*\\s*[:.\\-—–]?\\s*","i");return r.replace(t,"").trim()}catch(e){return""}}function O(e,n,r){return M.apply(this,arguments)}function M(){return(M=o(t().m(function e(n,r,a){var s,o,i,c,l,u,d,f,p,h,g,y,m,v,b,k,w,E,C,S,x,I,A,T,B,L,R;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.p=1,(s=r.getRange().fields).load("items"),e.n=2,n.sync();case 2:if(!s.items||!s.items.length){e.n=4;break}if(o=s.items.map(function(e){try{var n,r;return null===(n=(r=e).load)||void 0===n?void 0:n.call(r,"code")}catch(e){return null}}).filter(Boolean),!(o.length>0)){e.n=4;break}return e.n=3,n.sync();case 3:for(i=!1,c=!1,l=!1,u=!1,d=new RegExp("\\bSEQ\\s+"+a+"\\b","i"),f=0,p=s.items;f<p.length;f++){h=p[f];try{y=String(null!==(g=null==h?void 0:h.code)&&void 0!==g?g:""),/\bSTYLEREF\s+1\s+\\s\b/i.test(y)&&(i=!0),d.test(y)&&(c=!0),/\*\s*ARABIC\b/i.test(y)&&(l=!0),/\\s\s*1\b/i.test(y)&&(u=!0)}catch(e){console.warn("Error processing field code:",e)}}if(!(i&&c&&l&&u)){e.n=4;break}return e.a(2,!0);case 4:e.n=6;break;case 5:e.p=5,B=e.v,console.warn("Field API approach failed:",B);case 6:return e.p=6,m=r.getRange().getOoxml(),e.n=7,n.sync();case 7:if(v=String(m.value||""),b=/<w:fldSimple[^>]*\binstr="[^"]*\bSTYLEREF\s+1\s+\\s\b[^"]*"/i.test(v),k=new RegExp('<w:fldSimple[^>]*\\binstr="[^"]*\\bSEQ\\s+'+a+'\\b[^"]*\\*\\s*ARABIC[^"]*\\\\s\\s*1[^"]*"',"i").test(v),!b||!k){e.n=8;break}return e.a(2,!0);case 8:for(w=[],E=/<w:instrText\b[^>]*>([\s\S]*?)<\/w:instrText>/gi;null!==(C=E.exec(v));)w.push(C[1]),E.lastIndex===C.index&&E.lastIndex++;if(!w.length){e.n=9;break}if(S=w.join(""),x=/\bSTYLEREF\s*1\s*\\s\b/i.test(S),I=new RegExp("\\bSEQ\\s*"+a+"\\b","i").test(S),A=/\*\s*ARABIC\b/i.test(S),T=/\\s\s*1\b/i.test(S),!(x&&I&&A&&T)){e.n=9;break}return e.a(2,!0);case 9:return e.a(2,!1);case 10:return e.p=10,L=e.v,console.warn("OOXML approach failed:",L),e.a(2,!1);case 11:return e.p=11,R=e.v,console.error("Critical error in hasChapterSeqForLabelRobust:",R),e.a(2,!1);case 12:return e.a(2)}},e,null,[[6,10],[1,5],[0,11]])}))).apply(this,arguments)}function G(){return G=o(t().m(function e(){var n;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Word.run(function(){var e=o(t().m(function e(n){var r,a,s,o,c,l,u,f,p,h,g,y,m,v,b,k,w,E,C,S,x,I,A;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,(r=n.document.contentControls).load("items/tag"),e.n=1,n.sync();case 1:a=i(r.items),e.p=2,a.s();case 3:if((s=a.n()).done){e.n=6;break}if((o=s.value).tag&&o.tag.startsWith(d)){e.n=4;break}return e.a(3,5);case 4:try{(c=o.getRange()).font.highlightColor="NoColor",c.font.highlightColor="None"}catch(e){console.warn("Error clearing highlight:",e)}case 5:e.n=3;break;case 6:e.n=8;break;case 7:e.p=7,x=e.v,a.e(x);case 8:return e.p=8,a.f(),e.f(8);case 9:return e.n=10,n.sync();case 10:l=r.items.filter(function(e){return e.tag&&e.tag.startsWith(d)}),u=i(l);try{for(u.s();!(f=u.n()).done;){p=f.value;try{p.delete(!0)}catch(e){console.warn("Error deleting content control:",e)}}}catch(e){u.e(e)}finally{u.f()}return e.n=11,n.sync();case 11:return e.p=11,(h=n.document.body.paragraphs).load("items"),e.n=12,n.sync();case 12:g=i(h.items);try{for(g.s();!(y=g.n()).done;){m=y.value;try{(v=m.getRange()).font.highlightColor="NoColor",v.font.highlightColor="None"}catch(e){console.warn("Error clearing paragraph highlight:",e)}}}catch(e){g.e(e)}finally{g.f()}return e.n=13,n.sync();case 13:return(b=n.document.body.tables).load("items"),e.n=14,n.sync();case 14:k=i(b.items);try{for(k.s();!(w=k.n()).done;){E=w.value;try{(C=E.getRange()).font.highlightColor="NoColor",C.font.highlightColor="None"}catch(e){console.warn("Error clearing table highlight:",e)}}}catch(e){k.e(e)}finally{k.f()}return e.n=15,n.sync();case 15:return(S=n.document.body.getRange()).font.highlightColor="NoColor",S.font.highlightColor="None",e.n=16,n.sync();case 16:e.n=18;break;case 17:e.p=17,I=e.v,console.warn("Error with global highlight clearing:",I);case 18:e.n=20;break;case 19:e.p=19,A=e.v,console.error("Error in clearMarkers main logic:",A);case 20:return e.a(2)}},e,null,[[11,17],[2,7,8,9],[0,19]])}));return function(n){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,n=e.v,console.error("Critical error in clearMarkers:",n);case 3:return e.a(2)}},e,null,[[0,2]])})),G.apply(this,arguments)}function D(e){try{var n=document.getElementById("issuesList");if(!n)return;n.innerHTML="";var r,t=new Set(["figure-style","table-style"]),a=i(e);try{var s=function(){var e=r.value;try{var a=document.createElement("li");a.className="issue",a.dataset.tag=e.tag,a.style.cursor="pointer";var s=document.createElement("div");if(s.textContent="["+e.kind+"] "+e.message,a.appendChild(s),!t.has(e.kind)){var o=document.createElement("button");o.textContent="Fix",o.addEventListener("click",function(n){n.stopPropagation(),function(e){return $.apply(this,arguments)}(e).catch(function(e){console.error("Error fixing issue:",e)})}),a.appendChild(o)}n.appendChild(a)}catch(e){console.warn("Error rendering issue item:",e)}};for(a.s();!(r=a.n()).done;)s()}catch(e){a.e(e)}finally{a.f()}}catch(e){console.error("Error rendering issues:",e)}}function U(){return U=o(t().m(function e(n){var r;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Word.run(function(){var e=o(t().m(function e(r){var a,s;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,(a=r.document.contentControls.getByTag(d+n)).load("items"),e.n=1,r.sync();case 1:if(!(a.items.length>0)){e.n=2;break}return a.items[0].select(),e.n=2,r.sync();case 2:e.n=4;break;case 3:e.p=3,s=e.v,console.warn("Error jumping to specific issue:",s);case 4:return e.a(2)}},e,null,[[0,3]])}));return function(n){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,r=e.v,console.error("Critical error jumping to issue:",r);case 3:return e.a(2)}},e,null,[[0,2]])})),U.apply(this,arguments)}function $(){return $=o(t().m(function e(n){var r,a,s,i,c,l,u,f,g,y,b,k,w,E,C,S,x,I,A,T,B,L,R,N,F,j,O;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,k=m()||{},w=(null==k||null===(r=k.meta)||void 0===r?void 0:r.styleNameAliases)||{},E=null!==(a=null==k||null===(s=k.rules)||void 0===s||null===(s=s.styles)||void 0===s?void 0:s.bullets)&&void 0!==a?a:{},C=null!==(i=null==k||null===(c=k.rules)||void 0===c||null===(c=c.styles)||void 0===c?void 0:c.numberedLists)&&void 0!==i?i:{},S=null!==(l=E.allowed)&&void 0!==l?l:["TCC 글머리1","TCC 글머리2","TCC 글머리3","TCC 글머리4"],x=null!==(u=C.allowed)&&void 0!==u?u:["TCC 번호1","TCC 번호2","TCC 번호3"],I=(null==k||null===(f=k.rules)||void 0===f||null===(f=f.indentation)||void 0===f?void 0:f.expectedCmByStyle)||{},A=null!==(g=E.allowedIndentsCm)&&void 0!==g?g:[.71,1.21,1.71,2.21],T=null!==(y=C.allowedIndentsCm)&&void 0!==y?y:[.71,1.21,1.71],B=(null==k||null===(b=k.rules)||void 0===b||null===(b=b.styles)||void 0===b?void 0:b.captions)||{},L=B.figure||{},R=B.table||{},N=Array.isArray(L.style)?L.style[0]:L.style||"TCC 그림 캡션",F=R.styles||R.style||"캡션,TCC 표 캡션,표캡션TCC",j=Array.isArray(F)?F[0]:F,e.n=1,Word.run(function(){var e=o(t().m(function e(r){var a,s,o,i,c,l,u,f,g,y,m,b,k,E,C,B,L,R,F,O,M,G,D,U,$,P,W,_,z,Y,Z,q,H,Q,X,J;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,(a=r.document.contentControls.getByTag(d+n.tag)).load("items"),e.n=1,r.sync();case 1:if(0!==a.items.length){e.n=2;break}return e.a(2);case 2:return s=a.items[0],(o=s.getRange().paragraphs.getFirst()).load(["style","isListItem","leftIndent","firstLineIndent","text"]),e.n=3,r.sync();case 3:z=n.kind,e.n="bullet-style"===z?4:"numbered-style"===z?8:"indent"===z?12:"figure-empty"===z?16:"table-empty"===z?21:26;break;case 4:for(e.p=4,i=n.fixMeta||{},c=i.allowedStyles||S,l=i.allowedIndents||A,u=i.currentIndent||0,f=0,g=Math.abs(u-l[0]),y=1;y<l.length;y++)(m=Math.abs(u-l[y]))<g&&(g=m,f=y);return b=c[f],k=l[f],o.style=b,o.leftIndent=h(k),o.firstLineIndent=0,e.n=5,r.sync();case 5:console.log("[FIX] Applied ".concat(b," with ").concat(k,"cm indent")),e.n=7;break;case 6:e.p=6,Y=e.v,console.error("Error fixing bullet style:",Y);case 7:return e.a(3,26);case 8:for(e.p=8,E=n.fixMeta||{},C=E.allowedStyles||x,B=E.allowedIndents||T,L=E.currentIndent||0,R=0,F=Math.abs(L-B[0]),O=1;O<B.length;O++)(M=Math.abs(L-B[O]))<F&&(F=M,R=O);return G=C[R],D=B[R],o.style=G,o.leftIndent=h(D),o.firstLineIndent=0,e.n=9,r.sync();case 9:console.log("[FIX] Applied ".concat(G," with ").concat(D,"cm indent")),e.n=11;break;case 10:e.p=10,Z=e.v,console.error("Error fixing numbered style:",Z);case 11:return e.a(3,26);case 12:return e.p=12,P=null!==(U=null===($=n.fixMeta)||void 0===$?void 0:$.expectedCm)&&void 0!==U?U:function(){var e=o.style||"";if(e in I)return I[e];var n=v(e,w);if(n in I)return I[n];var r=o.text||"";return/^[\u2022\u25E6\u25AA\u25CF\u25CB\u25A0•◦○▪□\-–—]\s+/.test(r.trim())?A[0]:T[0]}(),W=p(o.firstLineIndent||0),_=P-W,o.leftIndent=h(_),e.n=13,r.sync();case 13:e.n=15;break;case 14:e.p=14,q=e.v,console.error("Error fixing indent:",q);case 15:return e.a(3,26);case 16:return e.p=16,o.style=N,e.n=17,r.sync();case 17:return o.select("End"),e.n=18,r.sync();case 18:e.n=20;break;case 19:e.p=19,H=e.v,console.error("Error fixing empty figure:",H);case 20:return e.a(3,26);case 21:return e.p=21,o.style=j,e.n=22,r.sync();case 22:return o.select("End"),e.n=23,r.sync();case 23:e.n=25;break;case 24:e.p=24,Q=e.v,console.error("Error fixing empty table:",Q);case 25:return e.a(3,26);case 26:return e.p=26,s.delete(!0),e.n=27,r.sync();case 27:e.n=29;break;case 28:e.p=28,X=e.v,console.warn("Error deleting content control after fix:",X);case 29:e.n=31;break;case 30:e.p=30,J=e.v,console.error("Error in Word.run for fix:",J);case 31:return e.a(2)}},e,null,[[26,28],[21,24],[16,19],[12,14],[8,10],[4,6],[0,30]])}));return function(n){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:throw e.p=2,O=e.v,console.error("Critical error in fixIssue:",O),O;case 3:return e.a(2)}},e,null,[[0,2]])})),$.apply(this,arguments)}}();
//# sourceMappingURL=taskpane.js.map